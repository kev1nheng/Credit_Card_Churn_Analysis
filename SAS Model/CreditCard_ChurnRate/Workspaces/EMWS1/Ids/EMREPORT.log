MPRINT(EM_DIAGRAM):    data _null_;
MPRINT(EM_DIAGRAM):   call symput('NLDATE', strip(put(date(), NLDATE.)));
MPRINT(EM_DIAGRAM):   call symput('NLTIME', strip(put(datetime(), NLTIME.)));
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   data _null_;
MPRINT(EM_DIAGRAM):   nldate= sasmsg("sashelp.dmine", "log_date_note", 'N', "March 31, 2022" );
MPRINT(EM_DIAGRAM):   nltime= sasmsg("sashelp.dmine", "log_time_note", 'N', "16:46:11" );
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   put "* Report Log";
MPRINT(EM_DIAGRAM):   put nldate;
MPRINT(EM_DIAGRAM):   put nltime;
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   run;
*------------------------------------------------------------*
* Report Log
Date:                March 31, 2022
Time:                16:46:11
*------------------------------------------------------------*
MPRINT(EM_DIAGRAM):    filename O3RSEHU7 "D:\478\project\CreditCard_ChurnRate\Workspaces\EMWS1\Ids\EMREPORT.out" encoding="UTF-8" NOBOM;
MPRINT(EM_DIAGRAM):   proc printto print=O3RSEHU7 new;
MPRINT(EM_DIAGRAM):   run;
22788      %EmAdviseStat(EMWS1.Ids_DATA, maxClassLevels=20, metadata=EMWS1.Ids_CMeta_DATA, statisticData=EMWS1.Ids_EMSTAT);
MPRINT(EM_DIAGRAM):   
MPRINT(EMADVISESTAT):   proc display c=sashelp.emmeta.advisestatistics.scl;
MPRINT(EMADVISESTAT):   run;

22789      %let SYSCC = 0;
*------------------------------------------------------------* 
Computing data source summary statistics 
*------------------------------------------------------------* 
22790      %let EM_ADVISENCOUNT = -1;
22791      %let _GridFlag = 0;
22792      %hpdm_performance(data=EMWS1.Ids_DATA, isGrid=_GridFlag);
MPRINT(EMADVISESTAT):    
MPRINT(HPDM_PERFORMANCE):  ;
PERFORMANCE  DETAILS
MPRINT(EMADVISESTAT):  ;
22793      proc dmdb data=EMWS1.Ids_DATA(obs=1000000)
22794      maxlevel = 513
22795      classout=WORK._CLASSSTAT varout=WORK._VARSTAT;
MPRINT(EMADVISESTAT):    proc dmdb data=EMWS1.Ids_DATA(obs=1000000) maxlevel = 513 classout=WORK._CLASSSTAT varout=WORK._VARSTAT;
22796      var
22797      'Avg_Open_To_Buy'n
22798      'Avg_Utilization_Ratio'n
22799      'Credit_Limit'n
22800      'Total_Amt_Chng_Q4_Q1'n
22801      'Total_Ct_Chng_Q4_Q1'n
22802      'Total_Revolving_Bal'n
22803      'Total_Trans_Amt'n
22804      ;
MPRINT(EMADVISESTAT):   var 'Avg_Open_To_Buy'n 'Avg_Utilization_Ratio'n 'Credit_Limit'n 'Total_Amt_Chng_Q4_Q1'n 'Total_Ct_Chng_Q4_Q1'n 'Total_Revolving_Bal'n 'Total_Trans_Amt'n ;
22805      class
22806      'Attrition_Flag'n
22807      'Card_Category'n
22808      'Contacts_Count_12_mon'n
22809      'Customer_Age'n
22810      'Dependent_count'n
22811      'Education_Level'n
22812      'Gender'n
22813      'Income_Category'n
22814      'Marital_Status'n
22815      'Months_Inactive_12_mon'n
22816      'Months_on_book'n
22817      'Total_Relationship_Count'n
22818      'Total_Trans_Ct'n
22819      ;
MPRINT(EMADVISESTAT):   class 'Attrition_Flag'n 'Card_Category'n 'Contacts_Count_12_mon'n 'Customer_Age'n 'Dependent_count'n 'Education_Level'n 'Gender'n 'Income_Category'n 'Marital_Status'n 'Months_Inactive_12_mon'n 'Months_on_book'n 
'Total_Relationship_Count'n 'Total_Trans_Ct'n ;
22820      run;
MPRINT(EMADVISESTAT):   run;

NOTE: Records processed = 10127   Memory used = 511K.
NOTE: There were 10127 observations read from the data set EMWS1.IDS_DATA.
NOTE: The data set WORK._CLASSSTAT has 266 observations and 9 variables.
NOTE: The data set WORK._VARSTAT has 7 observations and 9 variables.
NOTE: PROCEDURE DMDB used (Total process time):
      real time           0.02 seconds
      cpu time            0.03 seconds
      

22821      proc sort data=WORK._CLASSSTAT;
MPRINT(EMADVISESTAT):    proc sort data=WORK._CLASSSTAT;
22822      by NAME;
MPRINT(EMADVISESTAT):   by NAME;
22823      run;
MPRINT(EMADVISESTAT):   run;

NOTE: There were 266 observations read from the data set WORK._CLASSSTAT.
NOTE: The data set WORK._CLASSSTAT has 266 observations and 9 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

22824      data WORK._CLASSSTAT;
MPRINT(EMADVISESTAT):   data WORK._CLASSSTAT;
22825      set WORK._CLASSSTAT end=eof;
MPRINT(EMADVISESTAT):   set WORK._CLASSSTAT end=eof;
22826      retain NLEVEL PCTMISS NTOTAL 0;
MPRINT(EMADVISESTAT):   retain NLEVEL PCTMISS NTOTAL 0;
22827      KEEP NAME TYPE NLEVEL PCTMISS;
MPRINT(EMADVISESTAT):   KEEP NAME TYPE NLEVEL PCTMISS;
22828      by NAME;
MPRINT(EMADVISESTAT):   by NAME;
22829      if first.NAME then do;
MPRINT(EMADVISESTAT):   if first.NAME then do;
22830      NTOTAL = frequency;
MPRINT(EMADVISESTAT):   NTOTAL = frequency;
22831      if LEVEL in('', '.') and CRAW eq '' and NRAW=. then do;
MPRINT(EMADVISESTAT):   if LEVEL in('', '.') and CRAW eq '' and NRAW=. then do;
22832      PCTMISS=FREQPERCENT;
MPRINT(EMADVISESTAT):   PCTMISS=FREQPERCENT;
22833      NLEVEL = 0;
MPRINT(EMADVISESTAT):   NLEVEL = 0;
22834      end;
MPRINT(EMADVISESTAT):   end;
22835      else do;
MPRINT(EMADVISESTAT):   else do;
22836      NLEVEL=1;
MPRINT(EMADVISESTAT):   NLEVEL=1;
22837      PCTMISS=0;
MPRINT(EMADVISESTAT):   PCTMISS=0;
22838      end;
MPRINT(EMADVISESTAT):   end;
22839      end;
MPRINT(EMADVISESTAT):   end;
22840      else do;
MPRINT(EMADVISESTAT):   else do;
22841      NLEVEL + 1;
MPRINT(EMADVISESTAT):   NLEVEL + 1;
22842      NTOTAL + FREQUENCY;
MPRINT(EMADVISESTAT):   NTOTAL + FREQUENCY;
22843      end;
MPRINT(EMADVISESTAT):   end;
22844      if last.NAME then do;
MPRINT(EMADVISESTAT):   if last.NAME then do;
22845      if eof then call symput('EM_ADVISENCOUNT', strip(put(ntotal, best.)));
MPRINT(EMADVISESTAT):   if eof then call symput('EM_ADVISENCOUNT', strip(put(ntotal, best.)));
22846      output;
MPRINT(EMADVISESTAT):   output;
22847      end;
MPRINT(EMADVISESTAT):   end;
22848      run;
MPRINT(EMADVISESTAT):   run;

NOTE: There were 266 observations read from the data set WORK._CLASSSTAT.
NOTE: The data set WORK._CLASSSTAT has 13 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

22849      data WORK._VARSTAT;
MPRINT(EMADVISESTAT):    data WORK._VARSTAT;
22850      set WORK._VARSTAT end=eof;
MPRINT(EMADVISESTAT):   set WORK._VARSTAT end=eof;
22851      retain TYPE 'N';
MPRINT(EMADVISESTAT):   retain TYPE 'N';
22852      PCTMISS = 100*NMISS/(NMISS + N);
MPRINT(EMADVISESTAT):   PCTMISS = 100*NMISS/(NMISS + N);
22853      drop N
22854      ;
MPRINT(EMADVISESTAT):   drop N ;
22855      if eof then call symput('EM_ADVISENCOUNT', strip(put(nmiss + n, best.)));
MPRINT(EMADVISESTAT):   if eof then call symput('EM_ADVISENCOUNT', strip(put(nmiss + n, best.)));
22856      run;
MPRINT(EMADVISESTAT):   run;

NOTE: There were 7 observations read from the data set WORK._VARSTAT.
NOTE: The data set WORK._VARSTAT has 7 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

22857      data EMWS1.Ids_EMSTAT;
MPRINT(EMADVISESTAT):    data EMWS1.Ids_EMSTAT;
22858      length Name $32 Type $1 nlevel pctmiss min max mean std skewness kurtosis 8;
MPRINT(EMADVISESTAT):   length Name $32 Type $1 nlevel pctmiss min max mean std skewness kurtosis 8;
22859      label NAME = "%sysfunc(sasmsg(sashelp.dmine, meta_name_vlabel,  NOQUOTE))" TYPE = "%sysfunc(sasmsg(sashelp.dmine, meta_type_vlabel,  NOQUOTE))" NLEVEL = "%sysfunc(sasmsg(sashelp.dmine, rpt_numcat_vlabel,   NOQUOTE))" PCTMISS =
22860         "%sysfunc(sasmsg(sashelp.dmine, rpt_pctmissing_vlabel, NOQUOTE))" MIN = "%sysfunc(sasmsg(sashelp.dmine, rpt_minimum_vlabel, NOQUOTE))" MAX = "%sysfunc(sasmsg(sashelp.dmine, rpt_maximum_vlabel, NOQUOTE))" MEAN =
22861         "%sysfunc(sasmsg(sashelp.dmine, rpt_mean_vlabel,    NOQUOTE))" STD = "%sysfunc(sasmsg(sashelp.dmine, rpt_std_vlabel,     NOQUOTE))" SKEWNESS = "%sysfunc(sasmsg(sashelp.dmine, rpt_skewness_vlabel, NOQUOTE))" KURTOSIS =
22862         "%sysfunc(sasmsg(sashelp.dmine, rpt_kurtosis_vlabel, NOQUOTE))";
MPRINT(EMADVISESTAT):   label NAME = "Variable Name" TYPE = "Type" NLEVEL = "Number of Levels" PCTMISS = "Percent Missing" MIN = "Minimum" MAX = "Maximum" MEAN = "Mean" STD = "Standard Deviation" SKEWNESS = "Skewness" KURTOSIS = "Kurtosis";
22863      format NLEVEL 6.0 PCTMISS MIN MAX MEAN STD SKEWNESS KURTOSIS BEST8.3;
MPRINT(EMADVISESTAT):   format NLEVEL 6.0 PCTMISS MIN MAX MEAN STD SKEWNESS KURTOSIS BEST8.3;
22864      set WORK._VARSTAT WORK._CLASSSTAT;
MPRINT(EMADVISESTAT):   set WORK._VARSTAT WORK._CLASSSTAT;
22865      drop NMISS;
MPRINT(EMADVISESTAT):   drop NMISS;
22866      run;
MPRINT(EMADVISESTAT):   run;

NOTE: There were 7 observations read from the data set WORK._VARSTAT.
NOTE: There were 13 observations read from the data set WORK._CLASSSTAT.
NOTE: The data set EMWS1.IDS_EMSTAT has 20 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

22867      proc sort data=EMWS1.Ids_EMSTAT;
MPRINT(EMADVISESTAT):   proc sort data=EMWS1.Ids_EMSTAT;
22868      by NAME;
MPRINT(EMADVISESTAT):   by NAME;
22869      run;
MPRINT(EMADVISESTAT):   run;

NOTE: There were 20 observations read from the data set EMWS1.IDS_EMSTAT.
NOTE: The data set EMWS1.IDS_EMSTAT has 20 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

22870      proc sort data=WORK.M2XIYVQJ;
MPRINT(EMADVISESTAT):    proc sort data=WORK.M2XIYVQJ;
22871      by NAME;
MPRINT(EMADVISESTAT):   by NAME;
22872      run;
MPRINT(EMADVISESTAT):   run;

NOTE: There were 20 observations read from the data set WORK.M2XIYVQJ.
NOTE: The data set WORK.M2XIYVQJ has 20 observations and 20 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

22873      data WORK.M2XIYVQJ;
MPRINT(EMADVISESTAT):   data WORK.M2XIYVQJ;
22874      merge WORK.M2XIYVQJ EMWS1.Ids_EMSTAT(rename=(NLEVEL=newNLevel));
MPRINT(EMADVISESTAT):   merge WORK.M2XIYVQJ EMWS1.Ids_EMSTAT(rename=(NLEVEL=newNLevel));
22875      by NAME;
MPRINT(EMADVISESTAT):   by NAME;
22876      if FORMATTYPE in("DATE", "DATETIME", "TIME") then do;
MPRINT(EMADVISESTAT):   if FORMATTYPE in("DATE", "DATETIME", "TIME") then do;
22877      MEAN=.;
MPRINT(EMADVISESTAT):   MEAN=.;
22878      MIN=.;
MPRINT(EMADVISESTAT):   MIN=.;
22879      MAX=.;
MPRINT(EMADVISESTAT):   MAX=.;
22880      STD=.;
MPRINT(EMADVISESTAT):   STD=.;
22881      SKEWNESS=.;
MPRINT(EMADVISESTAT):   SKEWNESS=.;
22882      KURTOSIS=.;
MPRINT(EMADVISESTAT):   KURTOSIS=.;
22883      end;
MPRINT(EMADVISESTAT):   end;
22884      else if ROLE = 'ID' then do;
MPRINT(EMADVISESTAT):   else if ROLE = 'ID' then do;
22885      MEAN=.;
MPRINT(EMADVISESTAT):   MEAN=.;
22886      STD=.;
MPRINT(EMADVISESTAT):   STD=.;
22887      SKEWNESS=.;
MPRINT(EMADVISESTAT):   SKEWNESS=.;
22888      KURTOSIS=.;
MPRINT(EMADVISESTAT):   KURTOSIS=.;
22889      end;
MPRINT(EMADVISESTAT):   end;
22890      if NLEVEL ne newNLevel then do;
MPRINT(EMADVISESTAT):   if NLEVEL ne newNLevel then do;
22891      if 0< NLEVEL < 2 and newNLevel>1 and ROLE = 'REJECTED' then ROLE = 'INPUT';
MPRINT(EMADVISESTAT):   if 0< NLEVEL < 2 and newNLevel>1 and ROLE = 'REJECTED' then ROLE = 'INPUT';
22892      NLEVEL = newNLEVEL;
MPRINT(EMADVISESTAT):   NLEVEL = newNLEVEL;
22893      if NLEVEL = 1 then LEVEL='UNARY';
MPRINT(EMADVISESTAT):   if NLEVEL = 1 then LEVEL='UNARY';
22894      else if NLEVEL = 2 then LEVEL='BINARY';
MPRINT(EMADVISESTAT):   else if NLEVEL = 2 then LEVEL='BINARY';
22895      else if NLEVEL > 2 then LEVEL='NOMINAL';
MPRINT(EMADVISESTAT):   else if NLEVEL > 2 then LEVEL='NOMINAL';
22896      end;
MPRINT(EMADVISESTAT):   end;
22897      drop newNLevel;
MPRINT(EMADVISESTAT):   drop newNLevel;
22898      run;
MPRINT(EMADVISESTAT):   run;

NOTE: There were 20 observations read from the data set WORK.M2XIYVQJ.
NOTE: There were 20 observations read from the data set EMWS1.IDS_EMSTAT.
NOTE: The data set WORK.M2XIYVQJ has 20 observations and 28 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

22899      data EMWS1.Ids_CMeta_DATA;
MPRINT(EMADVISESTAT):    data EMWS1.Ids_CMeta_DATA;
22900      set WORK.M2XIYVQJ;
MPRINT(EMADVISESTAT):   set WORK.M2XIYVQJ;
22901      run;
MPRINT(EMADVISESTAT):   run;

NOTE: There were 20 observations read from the data set WORK.M2XIYVQJ.
NOTE: The data set EMWS1.IDS_CMETA_DATA has 20 observations and 28 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: PROCEDURE DISPLAY used (Total process time):
      real time           0.32 seconds
      cpu time            0.23 seconds
      

MPRINT(EMADVISESTAT):   
MPRINT(EM_DIAGRAM):  ;
22902      proc sort data=EMWS1.Ids_EMSTAT;
MPRINT(EM_DIAGRAM):   proc sort data=EMWS1.Ids_EMSTAT;
22903      by NAME;
MPRINT(EM_DIAGRAM):   by NAME;
22904      run;
MPRINT(EM_DIAGRAM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

22905      proc sort data=EMWS1.Ids_CMeta_DATA;
MPRINT(EM_DIAGRAM):   proc sort data=EMWS1.Ids_CMeta_DATA;
22906      by NAME;
MPRINT(EM_DIAGRAM):   by NAME;
22907      run;
MPRINT(EM_DIAGRAM):   run;

NOTE: There were 20 observations read from the data set EMWS1.IDS_CMETA_DATA.
NOTE: The data set EMWS1.IDS_CMETA_DATA has 20 observations and 28 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

22908      data EMWS1.Ids_CMeta_DATA;
MPRINT(EM_DIAGRAM):    data EMWS1.Ids_CMeta_DATA;
22909      set EMWS1.Ids_CMeta_DATA;
MPRINT(EM_DIAGRAM):   set EMWS1.Ids_CMeta_DATA;
22910      drop nlevel pctmiss min max mean std skewness kurtosis;
MPRINT(EM_DIAGRAM):   drop nlevel pctmiss min max mean std skewness kurtosis;
22911      run;
MPRINT(EM_DIAGRAM):   run;

NOTE: There were 20 observations read from the data set EMWS1.IDS_CMETA_DATA.
NOTE: The data set EMWS1.IDS_CMETA_DATA has 20 observations and 20 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

22912      data EMWS1.Ids_EMSTAT;
MPRINT(EM_DIAGRAM):   data EMWS1.Ids_EMSTAT;
22913      merge EMWS1.Ids_CMeta_DATA(keep=NAME TYPE LEVEL ROLE) EMWS1.Ids_EMSTAT;
MPRINT(EM_DIAGRAM):   merge EMWS1.Ids_CMeta_DATA(keep=NAME TYPE LEVEL ROLE) EMWS1.Ids_EMSTAT;
22914      label LEVEL = "%sysfunc(sasmsg(sashelp.dmine, meta_level_vlabel,     NOQUOTE))" ROLE = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel,      NOQUOTE))";
MPRINT(EM_DIAGRAM):   label LEVEL = "Measurement Level" ROLE = "Role";
22915      by NAME;
MPRINT(EM_DIAGRAM):   by NAME;
22916      run;
MPRINT(EM_DIAGRAM):   run;

NOTE: There were 20 observations read from the data set EMWS1.IDS_CMETA_DATA.
NOTE: There were 20 observations read from the data set EMWS1.IDS_EMSTAT.
NOTE: The data set EMWS1.IDS_EMSTAT has 20 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(EM_DIAGRAM):    proc printto;
MPRINT(EM_DIAGRAM):   run;
