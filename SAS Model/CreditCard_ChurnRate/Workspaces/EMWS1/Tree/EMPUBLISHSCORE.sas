****************************************************************;
******             DECISION TREE SCORING CODE             ******;
****************************************************************;
 
******         LENGTHS OF NEW CHARACTER VARIABLES         ******;
LENGTH I_Attrition_Flag  $   17;
LENGTH U_Attrition_Flag  $   17;
LENGTH _WARN_  $    4;
 
******              LABELS FOR NEW VARIABLES              ******;
label _NODE_ = 'Node' ;
label _LEAF_ = 'Leaf' ;
label P_Attrition_Flag0 = 'Predicted: Attrition_Flag=0' ;
label P_Attrition_Flag1 = 'Predicted: Attrition_Flag=1' ;
label Q_Attrition_Flag0 = 'Unadjusted P: Attrition_Flag=0' ;
label Q_Attrition_Flag1 = 'Unadjusted P: Attrition_Flag=1' ;
label V_Attrition_Flag0 = 'Validated: Attrition_Flag=0' ;
label V_Attrition_Flag1 = 'Validated: Attrition_Flag=1' ;
label I_Attrition_Flag = 'Into: Attrition_Flag' ;
label U_Attrition_Flag = 'Unnormalized Into: Attrition_Flag' ;
label _WARN_ = 'Warnings' ;
 
 
******      TEMPORARY VARIABLES FOR FORMATTED VALUES      ******;
LENGTH _ARBFMT_17 $     17; DROP _ARBFMT_17;
_ARBFMT_17 = ' '; /* Initialize to avoid warning. */
LENGTH _ARBFMT_12 $     12; DROP _ARBFMT_12;
_ARBFMT_12 = ' '; /* Initialize to avoid warning. */
 
 
******             ASSIGN OBSERVATION TO NODE             ******;
_ARBFMT_12 = PUT( G_Total_Trans_Ct , BEST12.);
 %DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('1' ,'3' ,'4' ,'2' ,'0' ) THEN DO;
  IF  NOT MISSING(RANGE_Total_Revolving_Bal ) AND
    RANGE_Total_Revolving_Bal  <     0.24215335717123 THEN DO;
    IF  NOT MISSING(RANGE_SQRT_Total_Ct_Chng_Q4_Q1 ) AND
          0.45221286754555 <= RANGE_SQRT_Total_Ct_Chng_Q4_Q1  THEN DO;
      _ARBFMT_12 = PUT( G_Total_Relationship_Count , BEST12.);
       %DMNORMIP( _ARBFMT_12);
      IF _ARBFMT_12 IN ('0' ) THEN DO;
        _NODE_  =                   24;
        _LEAF_  =                   15;
        P_Attrition_Flag0  =     0.05555555555555;
        P_Attrition_Flag1  =     0.94444444444444;
        Q_Attrition_Flag0  =     0.05555555555555;
        Q_Attrition_Flag1  =     0.94444444444444;
        V_Attrition_Flag0  =     0.11111111111111;
        V_Attrition_Flag1  =     0.88888888888888;
        I_Attrition_Flag  = '1' ;
        U_Attrition_Flag  = '1' ;
        END;
      ELSE DO;
        IF  NOT MISSING(RANGE_SQRT_Total_Amt_Chng_Q4_Q1 ) AND
          RANGE_SQRT_Total_Amt_Chng_Q4_Q1  <     0.43199033198472 THEN DO;
          _NODE_  =                   44;
          _LEAF_  =                   16;
          P_Attrition_Flag0  =                  0.4;
          P_Attrition_Flag1  =                  0.6;
          Q_Attrition_Flag0  =                  0.4;
          Q_Attrition_Flag1  =                  0.6;
          V_Attrition_Flag0  =     0.33333333333333;
          V_Attrition_Flag1  =     0.66666666666666;
          I_Attrition_Flag  = '1' ;
          U_Attrition_Flag  = '1' ;
          END;
        ELSE DO;
          _NODE_  =                   45;
          _LEAF_  =                   17;
          P_Attrition_Flag0  =               0.8125;
          P_Attrition_Flag1  =               0.1875;
          Q_Attrition_Flag0  =               0.8125;
          Q_Attrition_Flag1  =               0.1875;
          V_Attrition_Flag0  =                  0.8;
          V_Attrition_Flag1  =                  0.2;
          I_Attrition_Flag  = '0' ;
          U_Attrition_Flag  = '0' ;
          END;
        END;
      END;
    ELSE DO;
      _ARBFMT_12 = PUT( G_Months_Inactive_12_mon , BEST12.);
       %DMNORMIP( _ARBFMT_12);
      IF _ARBFMT_12 IN ('4' ) THEN DO;
        _NODE_  =                   22;
        _LEAF_  =                   12;
        P_Attrition_Flag0  =                 0.54;
        P_Attrition_Flag1  =                 0.46;
        Q_Attrition_Flag0  =                 0.54;
        Q_Attrition_Flag1  =                 0.46;
        V_Attrition_Flag0  =     0.83333333333333;
        V_Attrition_Flag1  =     0.16666666666666;
        I_Attrition_Flag  = '0' ;
        U_Attrition_Flag  = '0' ;
        END;
      ELSE DO;
        _ARBFMT_12 = PUT( G_Customer_Age , BEST12.);
         %DMNORMIP( _ARBFMT_12);
        IF _ARBFMT_12 IN ('9' ) THEN DO;
          _NODE_  =                   42;
          _LEAF_  =                   13;
          P_Attrition_Flag0  =                 0.75;
          P_Attrition_Flag1  =                 0.25;
          Q_Attrition_Flag0  =                 0.75;
          Q_Attrition_Flag1  =                 0.25;
          V_Attrition_Flag0  =                    1;
          V_Attrition_Flag1  =                    0;
          I_Attrition_Flag  = '0' ;
          U_Attrition_Flag  = '0' ;
          END;
        ELSE DO;
          _NODE_  =                   43;
          _LEAF_  =                   14;
          P_Attrition_Flag0  =     0.08902691511387;
          P_Attrition_Flag1  =     0.91097308488612;
          Q_Attrition_Flag0  =     0.08902691511387;
          Q_Attrition_Flag1  =     0.91097308488612;
          V_Attrition_Flag0  =      0.1418439716312;
          V_Attrition_Flag1  =     0.85815602836879;
          I_Attrition_Flag  = '1' ;
          U_Attrition_Flag  = '1' ;
          END;
        END;
      END;
    END;
  ELSE DO;
    _ARBFMT_12 = PUT( G_Total_Relationship_Count , BEST12.);
     %DMNORMIP( _ARBFMT_12);
    IF _ARBFMT_12 IN ('0' ) THEN DO;
      _ARBFMT_12 = PUT( G_Months_Inactive_12_mon , BEST12.);
       %DMNORMIP( _ARBFMT_12);
      IF _ARBFMT_12 IN ('4' ) THEN DO;
        _NODE_  =                   27;
        _LEAF_  =                   19;
        P_Attrition_Flag0  =     0.66666666666666;
        P_Attrition_Flag1  =     0.33333333333333;
        Q_Attrition_Flag0  =     0.66666666666666;
        Q_Attrition_Flag1  =     0.33333333333333;
        V_Attrition_Flag0  =     0.66666666666666;
        V_Attrition_Flag1  =     0.33333333333333;
        I_Attrition_Flag  = '0' ;
        U_Attrition_Flag  = '0' ;
        END;
      ELSE DO;
        _NODE_  =                   26;
        _LEAF_  =                   18;
        P_Attrition_Flag0  =     0.12222222222222;
        P_Attrition_Flag1  =     0.87777777777777;
        Q_Attrition_Flag0  =     0.12222222222222;
        Q_Attrition_Flag1  =     0.87777777777777;
        V_Attrition_Flag0  =     0.14285714285714;
        V_Attrition_Flag1  =     0.85714285714285;
        I_Attrition_Flag  = '1' ;
        U_Attrition_Flag  = '1' ;
        END;
      END;
    ELSE DO;
      IF  NOT MISSING(RANGE_LOG_Total_Trans_Amt ) AND
            0.11922630474959 <= RANGE_LOG_Total_Trans_Amt  THEN DO;
        IF  NOT MISSING(RANGE_SQRT_Total_Ct_Chng_Q4_Q1 ) AND
          RANGE_SQRT_Total_Ct_Chng_Q4_Q1  <     0.41234945173394 THEN DO;
          _ARBFMT_12 = PUT( G_Customer_Age , BEST12.);
           %DMNORMIP( _ARBFMT_12);
          IF _ARBFMT_12 IN ('9' ,'8' ) THEN DO;
            _NODE_  =                   72;
            _LEAF_  =                   22;
            P_Attrition_Flag0  =                 0.85;
            P_Attrition_Flag1  =                 0.15;
            Q_Attrition_Flag0  =                 0.85;
            Q_Attrition_Flag1  =                 0.15;
            V_Attrition_Flag0  =                 0.75;
            V_Attrition_Flag1  =                 0.25;
            I_Attrition_Flag  = '0' ;
            U_Attrition_Flag  = '0' ;
            END;
          ELSE DO;
            _NODE_  =                   73;
            _LEAF_  =                   23;
            P_Attrition_Flag0  =            0.2265625;
            P_Attrition_Flag1  =            0.7734375;
            Q_Attrition_Flag0  =            0.2265625;
            Q_Attrition_Flag1  =            0.7734375;
            V_Attrition_Flag0  =     0.33333333333333;
            V_Attrition_Flag1  =     0.66666666666666;
            I_Attrition_Flag  = '1' ;
            U_Attrition_Flag  = '1' ;
            END;
          END;
        ELSE DO;
          _NODE_  =                   51;
          _LEAF_  =                   24;
          P_Attrition_Flag0  =     0.83957219251336;
          P_Attrition_Flag1  =     0.16042780748663;
          Q_Attrition_Flag0  =     0.83957219251336;
          Q_Attrition_Flag1  =     0.16042780748663;
          V_Attrition_Flag0  =     0.84482758620689;
          V_Attrition_Flag1  =      0.1551724137931;
          I_Attrition_Flag  = '0' ;
          U_Attrition_Flag  = '0' ;
          END;
        END;
      ELSE DO;
        IF  NOT MISSING(RANGE_LOG_Total_Trans_Amt ) AND
          RANGE_LOG_Total_Trans_Amt  <     0.03539998717758 THEN DO;
          _NODE_  =                   48;
          _LEAF_  =                   20;
          P_Attrition_Flag0  =     0.09090909090909;
          P_Attrition_Flag1  =      0.9090909090909;
          Q_Attrition_Flag0  =     0.09090909090909;
          Q_Attrition_Flag1  =      0.9090909090909;
          V_Attrition_Flag0  =                  0.2;
          V_Attrition_Flag1  =                  0.8;
          I_Attrition_Flag  = '1' ;
          U_Attrition_Flag  = '1' ;
          END;
        ELSE DO;
          _NODE_  =                   49;
          _LEAF_  =                   21;
          P_Attrition_Flag0  =     0.93779160186625;
          P_Attrition_Flag1  =     0.06220839813374;
          Q_Attrition_Flag0  =     0.93779160186625;
          Q_Attrition_Flag1  =     0.06220839813374;
          V_Attrition_Flag0  =     0.95555555555555;
          V_Attrition_Flag1  =     0.04444444444444;
          I_Attrition_Flag  = '0' ;
          U_Attrition_Flag  = '0' ;
          END;
        END;
      END;
    END;
  END;
ELSE DO;
  IF  NOT MISSING(RANGE_SQRT_Total_Ct_Chng_Q4_Q1 ) AND
    RANGE_SQRT_Total_Ct_Chng_Q4_Q1  <      0.3183909236815 THEN DO;
    _ARBFMT_12 = PUT( G_Total_Relationship_Count , BEST12.);
     %DMNORMIP( _ARBFMT_12);
    IF _ARBFMT_12 IN ('0' ) THEN DO;
      _NODE_  =                    8;
      _LEAF_  =                    1;
      P_Attrition_Flag0  =                 0.04;
      P_Attrition_Flag1  =                 0.96;
      Q_Attrition_Flag0  =                 0.04;
      Q_Attrition_Flag1  =                 0.96;
      V_Attrition_Flag0  =                    0;
      V_Attrition_Flag1  =                    1;
      I_Attrition_Flag  = '1' ;
      U_Attrition_Flag  = '1' ;
      END;
    ELSE DO;
      IF  NOT MISSING(RANGE_LOG_Total_Trans_Amt ) AND
            0.08300830873515 <= RANGE_LOG_Total_Trans_Amt  THEN DO;
        _ARBFMT_12 = PUT( G_Total_Trans_Ct , BEST12.);
         %DMNORMIP( _ARBFMT_12);
        IF _ARBFMT_12 IN ('5' ) THEN DO;
          _NODE_  =                   32;
          _LEAF_  =                    3;
          P_Attrition_Flag0  =     0.22857142857142;
          P_Attrition_Flag1  =     0.77142857142857;
          Q_Attrition_Flag0  =     0.22857142857142;
          Q_Attrition_Flag1  =     0.77142857142857;
          V_Attrition_Flag0  =     0.22222222222222;
          V_Attrition_Flag1  =     0.77777777777777;
          I_Attrition_Flag  = '1' ;
          U_Attrition_Flag  = '1' ;
          END;
        ELSE DO;
          _NODE_  =                   33;
          _LEAF_  =                    4;
          P_Attrition_Flag0  =                  0.8;
          P_Attrition_Flag1  =                  0.2;
          Q_Attrition_Flag0  =                  0.8;
          Q_Attrition_Flag1  =                  0.2;
          V_Attrition_Flag0  =                    1;
          V_Attrition_Flag1  =                    0;
          I_Attrition_Flag  = '0' ;
          U_Attrition_Flag  = '0' ;
          END;
        END;
      ELSE DO;
        _NODE_  =                   16;
        _LEAF_  =                    2;
        P_Attrition_Flag0  =     0.76388888888888;
        P_Attrition_Flag1  =     0.23611111111111;
        Q_Attrition_Flag0  =     0.76388888888888;
        Q_Attrition_Flag1  =     0.23611111111111;
        V_Attrition_Flag0  =     0.73333333333333;
        V_Attrition_Flag1  =     0.26666666666666;
        I_Attrition_Flag  = '0' ;
        U_Attrition_Flag  = '0' ;
        END;
      END;
    END;
  ELSE DO;
    IF  NOT MISSING(RANGE_Total_Revolving_Bal ) AND
      RANGE_Total_Revolving_Bal  <     0.22804926499801 THEN DO;
      IF  NOT MISSING(RANGE_LOG_Total_Trans_Amt ) AND
            0.34801787120737 <= RANGE_LOG_Total_Trans_Amt  THEN DO;
        _ARBFMT_12 = PUT( G_Total_Trans_Ct , BEST12.);
         %DMNORMIP( _ARBFMT_12);
        IF _ARBFMT_12 IN ('5' ,'6' ) THEN DO;
          _NODE_  =                   37;
          _LEAF_  =                    9;
          P_Attrition_Flag0  =     0.01492537313432;
          P_Attrition_Flag1  =     0.98507462686567;
          Q_Attrition_Flag0  =     0.01492537313432;
          Q_Attrition_Flag1  =     0.98507462686567;
          V_Attrition_Flag0  =                    0;
          V_Attrition_Flag1  =                    1;
          I_Attrition_Flag  = '1' ;
          U_Attrition_Flag  = '1' ;
          END;
        ELSE DO;
          _NODE_  =                   36;
          _LEAF_  =                    8;
          P_Attrition_Flag0  =     0.75776397515527;
          P_Attrition_Flag1  =     0.24223602484472;
          Q_Attrition_Flag0  =     0.75776397515527;
          Q_Attrition_Flag1  =     0.24223602484472;
          V_Attrition_Flag0  =     0.65853658536585;
          V_Attrition_Flag1  =     0.34146341463414;
          I_Attrition_Flag  = '0' ;
          U_Attrition_Flag  = '0' ;
          END;
        END;
      ELSE DO;
        _ARBFMT_12 = PUT( G_Total_Trans_Ct , BEST12.);
         %DMNORMIP( _ARBFMT_12);
        IF _ARBFMT_12 IN ('5' ) THEN DO;
          IF  NOT MISSING(RANGE_SQRT_Total_Ct_Chng_Q4_Q1 ) AND
            RANGE_SQRT_Total_Ct_Chng_Q4_Q1  <     0.39278572866989 THEN DO;
            _NODE_  =                   56;
            _LEAF_  =                    6;
            P_Attrition_Flag0  =     0.27450980392156;
            P_Attrition_Flag1  =     0.72549019607843;
            Q_Attrition_Flag0  =     0.27450980392156;
            Q_Attrition_Flag1  =     0.72549019607843;
            V_Attrition_Flag0  =     0.36842105263157;
            V_Attrition_Flag1  =     0.63157894736842;
            I_Attrition_Flag  = '1' ;
            U_Attrition_Flag  = '1' ;
            END;
          ELSE DO;
            _NODE_  =                   57;
            _LEAF_  =                    7;
            P_Attrition_Flag0  =     0.73972602739726;
            P_Attrition_Flag1  =     0.26027397260273;
            Q_Attrition_Flag0  =     0.73972602739726;
            Q_Attrition_Flag1  =     0.26027397260273;
            V_Attrition_Flag0  =     0.73529411764705;
            V_Attrition_Flag1  =     0.26470588235294;
            I_Attrition_Flag  = '0' ;
            U_Attrition_Flag  = '0' ;
            END;
          END;
        ELSE DO;
          _NODE_  =                   34;
          _LEAF_  =                    5;
          P_Attrition_Flag0  =     0.98959687906371;
          P_Attrition_Flag1  =     0.01040312093628;
          Q_Attrition_Flag0  =     0.98959687906371;
          Q_Attrition_Flag1  =     0.01040312093628;
          V_Attrition_Flag0  =     0.97630331753554;
          V_Attrition_Flag1  =     0.02369668246445;
          I_Attrition_Flag  = '0' ;
          U_Attrition_Flag  = '0' ;
          END;
        END;
      END;
    ELSE DO;
      IF  NOT MISSING(RANGE_LOG_Total_Trans_Amt ) AND
        RANGE_LOG_Total_Trans_Amt  <     0.03340216054825 THEN DO;
        _NODE_  =                   20;
        _LEAF_  =                   10;
        P_Attrition_Flag0  =                    0;
        P_Attrition_Flag1  =                    1;
        Q_Attrition_Flag0  =                    0;
        Q_Attrition_Flag1  =                    1;
        V_Attrition_Flag0  =                    0;
        V_Attrition_Flag1  =                    1;
        I_Attrition_Flag  = '1' ;
        U_Attrition_Flag  = '1' ;
        END;
      ELSE DO;
        _NODE_  =                   21;
        _LEAF_  =                   11;
        P_Attrition_Flag0  =     0.97381546134663;
        P_Attrition_Flag1  =     0.02618453865336;
        Q_Attrition_Flag0  =     0.97381546134663;
        Q_Attrition_Flag1  =     0.02618453865336;
        V_Attrition_Flag0  =     0.97646033129904;
        V_Attrition_Flag1  =     0.02353966870095;
        I_Attrition_Flag  = '0' ;
        U_Attrition_Flag  = '0' ;
        END;
      END;
    END;
  END;
 
****************************************************************;
******          END OF DECISION TREE SCORING CODE         ******;
****************************************************************;
 
drop _LEAF_;
